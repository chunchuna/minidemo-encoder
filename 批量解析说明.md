# CS:GO Demo 批量解析功能说明

## 功能介绍

批量解析功能可以一次性解析指定文件夹中的所有 `.dem` 文件，每个 demo 的解析结果会自动保存到独立的文件夹中。

## 使用方法

### 方法一：使用快捷脚本（推荐）

#### Windows 系统

双击运行 `batch_parse.bat` 或在命令行中执行：

```batch
batch_parse.bat [demo文件夹路径]
```

**示例：**
```batch
REM 解析当前目录下的 demo 文件夹
batch_parse.bat

REM 解析指定路径的 demo 文件夹
batch_parse.bat "D:\CSGO\demos"
```

#### Linux/Mac 系统

首先给脚本添加执行权限：
```bash
chmod +x batch_parse.sh
```

然后执行：
```bash
./batch_parse.sh [demo文件夹路径]
```

**示例：**
```bash
# 解析当前目录下的 demo 文件夹
./batch_parse.sh

# 解析指定路径的 demo 文件夹
./batch_parse.sh ~/csgo/demos
```

### 方法二：直接使用命令行

#### 1. 编译程序

```bash
# Windows
go build -o minidemo-encoder.exe .\cmd\main.go

# Linux/Mac
go build -o minidemo-encoder ./cmd/main.go
```

#### 2. 执行批量解析

```bash
# Windows
minidemo-encoder.exe -dir="path\to\demo\folder"

# Linux/Mac
./minidemo-encoder -dir="path/to/demo/folder"
```

## 输出结构

解析后的文件会按照以下结构保存：

```
output/
├── demo1/                    # 第一个 demo 的名称
│   ├── round1_T5-CT5/       # 回合1
│   │   ├── t/               # T 方玩家
│   │   │   ├── player1.rec
│   │   │   └── player2.rec
│   │   └── ct/              # CT 方玩家
│   │       ├── player3.rec
│   │       └── player4.rec
│   └── round2_T4-CT5/       # 回合2
│       └── ...
├── demo2/                    # 第二个 demo 的名称
│   └── ...
└── demo3/                    # 第三个 demo 的名称
    └── ...
```

## 注意事项

1. **Demo 文件格式**：确保文件夹中的文件是 `.dem` 格式
2. **文件夹路径**：如果路径包含空格或特殊字符，请用引号括起来
3. **默认目录**：如果不指定目录，默认会解析 `./demo` 文件夹
4. **输出目录**：所有解析结果默认保存在 `./output` 目录中
5. **文件名命名**：输出文件夹名称会自动使用 demo 文件的名称（不含扩展名）

## 示例

假设您有以下 demo 文件：

```
demo/
├── match1.dem
├── match2.dem
└── tournament_final.dem
```

执行批量解析后，输出结构为：

```
output/
├── match1/
│   ├── round1_T5-CT5/
│   └── ...
├── match2/
│   ├── round1_T5-CT5/
│   └── ...
└── tournament_final/
    ├── round1_T5-CT5/
    └── ...
```

## 单文件解析

如果只需要解析单个 demo 文件，可以使用：

```bash
# Windows
minidemo-encoder.exe -file="path\to\demo.dem"

# Linux/Mac
./minidemo-encoder -file="path/to/demo.dem"
```

单文件解析的输出会直接保存在 `./output` 目录中，不会创建子文件夹。

## 故障排除

### 问题：找不到任何 .dem 文件

**解决方法：**
- 确认文件夹路径正确
- 确认文件扩展名是 `.dem`（不区分大小写）
- 检查文件夹权限

### 问题：编译失败

**解决方法：**
- 确认已安装 Go 环境
- 检查网络连接（需要下载依赖）
- 尝试手动执行 `go mod tidy` 更新依赖

### 问题：解析出错

**解决方法：**
- 检查 demo 文件是否损坏
- 确认 demo 文件格式正确
- 查看控制台错误信息

## 技术支持

如有问题，请查看程序输出的错误信息或联系技术支持。 