# CS:GO Demo èŠå¤©è®°å½•æ‰‹åŠ¨æ’­æ”¾åŠŸèƒ½

## åŠŸèƒ½è¯´æ˜

è¿™æ˜¯ä¸€ä¸ª**ç®€åŒ–ç‰ˆçš„èŠå¤©é‡ç°åŠŸèƒ½**ï¼Œä¸ä¼šè‡ªåŠ¨åŒæ­¥æ’­æ”¾èŠå¤©ï¼Œè€Œæ˜¯è®©ç©å®¶ä½¿ç”¨ **`!saychat`** å‘½ä»¤æ‰‹åŠ¨è§¦å‘ï¼Œæ¯æ¬¡éšæœºæ’­æ”¾ä¸€æ¡èŠå¤©æ¶ˆæ¯ã€‚

## ç‰¹ç‚¹

âœ… **ç®€å•æ˜“ç”¨** - åªéœ€è¾“å…¥ `!saychat` å°±èƒ½éšæœºæ’­æ”¾ä¸€æ¡èŠå¤©  
âœ… **æ‰‹åŠ¨æ§åˆ¶** - æƒ³ä»€ä¹ˆæ—¶å€™æ’­æ”¾å°±ä»€ä¹ˆæ—¶å€™æ’­æ”¾  
âœ… **éšæœºæœ‰è¶£** - æ¯æ¬¡éƒ½æ˜¯éšæœºæŠ½å–ä¸€æ¡æ¶ˆæ¯  
âœ… **è‡ªåŠ¨åŠ è½½** - å›æ”¾å¼€å§‹æ—¶è‡ªåŠ¨åŠ è½½èŠå¤©è®°å½•  

## ä½¿ç”¨æ–¹æ³•

### 1. ç¼–è¯‘æ’ä»¶

éœ€è¦ç¼–è¯‘ä¸¤ä¸ªæ’ä»¶ï¼š

```bash
# è¿›å…¥ç¼–è¯‘ç›®å½•
cd addons/sourcemod/scripting/

# ç¼–è¯‘èŠå¤©é‡ç°æ’ä»¶
spcomp demo_chat_replay.sp

# ç¼–è¯‘ demomimic_test æ’ä»¶
spcomp demomimic_test.sp

# å¤åˆ¶åˆ° plugins ç›®å½•
copy demo_chat_replay.smx ..\plugins\
copy demomimic_test.smx ..\plugins\
```

### 2. æ¸¸æˆä¸­ä½¿ç”¨

#### æ­¥éª¤ 1ï¼šå¼€å§‹å›æ”¾
```
!testdemo
```
é€‰æ‹©è¦å›æ”¾çš„æ¯”èµ›

#### æ­¥éª¤ 2ï¼šæ’­æ”¾èŠå¤©
å›åˆå¼€å§‹åï¼Œæ¸¸æˆä¼šæç¤ºï¼š
```
[Chat Replay] ğŸ’¬ Loaded 15 chat messages - Use !saychat to play
[Chat Replay] ğŸ’¬ å·²åŠ è½½ 15 æ¡èŠå¤© - ä½¿ç”¨ !saychat æ’­æ”¾
```

#### æ­¥éª¤ 3ï¼šéšæœºæ’­æ”¾èŠå¤©
è¾“å…¥å‘½ä»¤ï¼š
```
!saychat
```
æˆ–è€…
```
saychat
```

æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šéšæœºæ’­æ”¾ä¸€æ¡èŠå¤©æ¶ˆæ¯ï¼

## å‘½ä»¤åˆ—è¡¨

| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `!saychat` | éšæœºæ’­æ”¾ä¸€æ¡èŠå¤© | `!saychat` |
| `saychat` | åŒä¸Šï¼ˆä¸å¸¦ ! ä¹Ÿå¯ä»¥ï¼‰ | `saychat` |
| `!chat_toggle` | å¼€å…³èŠå¤©åŠŸèƒ½ | `!chat_toggle` |
| `!testdemo` | æ‰“å¼€å›æ”¾èœå• | `!testdemo` |

## èŠå¤©æ¶ˆæ¯æ˜¾ç¤ºæ•ˆæœ

å½“ä½ ä½¿ç”¨ `!saychat` æ—¶ï¼Œä¼šçœ‹åˆ°ï¼š

```
[CHAT] (T) dev1ce: nice shot
[Chat Replay] Played message 5/15
[Chat Replay] æ’­æ”¾äº†ç¬¬ 5/15 æ¡æ¶ˆæ¯
```

## é…ç½®

### ConVar è®¾ç½®

å¯ä»¥åœ¨ `server.cfg` æˆ–æ§åˆ¶å°ä¸­è®¾ç½®ï¼š

```cfg
// å¯ç”¨/ç¦ç”¨èŠå¤©é‡ç°
sm_match_chat_replay 1    // 1=å¯ç”¨, 0=ç¦ç”¨
```

### é»˜è®¤è®¾ç½®

æ’ä»¶é»˜è®¤å·²å¯ç”¨èŠå¤©é‡ç°åŠŸèƒ½ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

## å¸¸è§é—®é¢˜

### Q1: æç¤º"No chat messages loaded!"æ€ä¹ˆåŠï¼Ÿ

**åŸå› ï¼š**
- å½“å‰å›åˆæ²¡æœ‰èŠå¤©è®°å½•
- demo æ–‡ä»¶ä¸­æ²¡æœ‰èŠå¤©æ¶ˆæ¯
- èŠå¤©æ–‡ä»¶ä¸¢å¤±

**è§£å†³æ–¹æ³•ï¼š**
1. ç¡®è®¤ demo è§£ææ—¶ç”Ÿæˆäº†èŠå¤©æ–‡ä»¶ï¼ˆ`roundX_chat.txt`ï¼‰
2. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åœ¨æ­£ç¡®çš„ä½ç½®
3. é‡æ–°å¼€å§‹ä¸€ä¸ªå›æ”¾

### Q2: æ¯æ¬¡éƒ½æ’­æ”¾ç›¸åŒçš„æ¶ˆæ¯å—ï¼Ÿ

**ä¸ä¼šï¼** æ¯æ¬¡ä½¿ç”¨ `!saychat` éƒ½ä¼š**éšæœº**é€‰æ‹©ä¸€æ¡ä¸åŒçš„æ¶ˆæ¯æ’­æ”¾ã€‚

### Q3: å¯ä»¥è¿ç»­æ’­æ”¾å¤šæ¡å—ï¼Ÿ

**å¯ä»¥ï¼** åªéœ€è¦å¤šæ¬¡è¾“å…¥ `!saychat` å³å¯ï¼š

```
!saychat
!saychat
!saychat
```

æ¯æ¬¡éƒ½ä¼šéšæœºæ’­æ”¾ä¸åŒçš„æ¶ˆæ¯ã€‚

### Q4: å¦‚ä½•æŸ¥çœ‹æ€»å…±æœ‰å¤šå°‘æ¡èŠå¤©ï¼Ÿ

æ¯æ¬¡ä½¿ç”¨ `!saychat` åï¼Œä¼šæ˜¾ç¤ºï¼š
```
[Chat Replay] Played message 5/15
```
è¿™è¡¨ç¤ºæ€»å…±æœ‰ 15 æ¡æ¶ˆæ¯ï¼Œåˆšæ’­æ”¾çš„æ˜¯ç¬¬ 5 æ¡ã€‚

### Q5: å¦‚ä½•å…³é—­èŠå¤©åŠŸèƒ½ï¼Ÿ

ä½¿ç”¨å‘½ä»¤ï¼š
```
!chat_toggle
```

æˆ–è€…åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼š
```
sm_match_chat_replay 0
```

## å®Œæ•´å·¥ä½œæµç¨‹

### 1. å‡†å¤‡é˜¶æ®µ

```bash
# è§£æ demo æ–‡ä»¶ï¼ˆç”ŸæˆèŠå¤©è®°å½•ï¼‰
cd minidemo-encoder
minidemo-encoder.exe -dir="demoæ–‡ä»¶å¤¹"

# å¤åˆ¶è¾“å‡ºæ–‡ä»¶åˆ°æœåŠ¡å™¨
# output/[tickrate][demoName]/ -> csgo/addons/sourcemod/data/botmimic/demotest/[åœ°å›¾]/[æ¯”èµ›ç¼–å·]/
```

### 2. æœåŠ¡å™¨é…ç½®

```bash
# ç¼–è¯‘æ’ä»¶
cd addons/sourcemod/scripting/
spcomp demo_chat_replay.sp
spcomp demomimic_test.sp

# å®‰è£…æ’ä»¶
copy *.smx ..\plugins\
```

### 3. æ¸¸æˆä¸­ä½¿ç”¨

```
1. ç©å®¶è¿›å…¥æœåŠ¡å™¨
2. è¾“å…¥: !testdemo
3. é€‰æ‹©è¦å›æ”¾çš„æ¯”èµ›
4. ç­‰å¾…å›åˆå¼€å§‹
5. çœ‹åˆ°æç¤º: "Loaded X chat messages - Use !saychat to play"
6. è¾“å…¥: !saychat
7. çœ‹åˆ°éšæœºæ’­æ”¾çš„èŠå¤©æ¶ˆæ¯ï¼
8. ç»§ç»­è¾“å…¥ !saychat æ’­æ”¾æ›´å¤šæ¶ˆæ¯
```

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šæš–åœºå¨±ä¹
```
æœä¸»ï¼š!saychat
[CHAT] (CT) s1mple: rush B no stop
æ‰€æœ‰äººï¼šå“ˆå“ˆå“ˆ
```

### åœºæ™¯ 2ï¼šå­¦ä¹ èŒä¸šé€‰æ‰‹äº¤æµ
```
ç©å®¶ï¼š!saychat
[CHAT] (T) NiKo: smoke mid
ç©å®¶ï¼šåŸæ¥è¿™æ³¢è¦çƒŸä¸­è·¯
```

### åœºæ™¯ 3ï¼šè¿ç»­æ’­æ”¾åˆ¶é€ æ°”æ°›
```
!saychat
[CHAT] (T) dev1ce: nice
!saychat
[CHAT] (CT) ZywOo: ns
!saychat
[CHAT] (T) NiKo: gg
```

## æŠ€æœ¯ç»†èŠ‚

### èŠå¤©æ–‡ä»¶æ ¼å¼

æ’ä»¶ä¼šè¯»å– `roundX_chat.txt` æ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```
=== Chat Messages - Round 1 ===
Total Messages: 3
============================================================

[1] Tick: 5230
    Type: All
    Sender: dev1ce (Team: T)
    Message: nice shot

[2] Tick: 8450
    Type: Team
    Sender: s1mple (Team: CT)
    Message: rushing B
```

### æ¶ˆæ¯åŠ è½½æ—¶æœº

- **åŠ è½½æ—¶æœº**ï¼šå›åˆå†»ç»“æ—¶é—´ç»“æŸæ—¶ï¼ˆ`Event_FreezeTimeEnd`ï¼‰
- **æ¸…ç©ºæ—¶æœº**ï¼šå›åˆç»“æŸæ—¶ï¼ˆ`Event_RoundEnd`ï¼‰
- **å­˜å‚¨ä½ç½®**ï¼šæ’ä»¶å†…å­˜ä¸­ï¼ˆ`g_hChatMessages`ï¼‰

### éšæœºç®—æ³•

ä½¿ç”¨ SourceMod çš„ `GetRandomInt()` å‡½æ•°ä»æ¶ˆæ¯åˆ—è¡¨ä¸­éšæœºé€‰æ‹©ï¼š

```sourcepawn
int randomIndex = GetRandomInt(0, g_hChatMessages.Length - 1);
```

## é«˜çº§åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

### è‡ªå®šä¹‰èŠå¤©æ˜¾ç¤ºæ ¼å¼

ä¿®æ”¹ `demo_chat_replay.sp` ä¸­çš„ `DisplayChatMessage` å‡½æ•°ï¼š

```sourcepawn
void DisplayChatMessage(ChatMessageInfo msg)
{
    // è‡ªå®šä¹‰æ ¼å¼
    char sFormattedMsg[512];
    Format(sFormattedMsg, sizeof(sFormattedMsg), 
        "\x01[\x06å›æ”¾\x01] %s: %s",  // ä½¿ç”¨ä¸­æ–‡æ ‡ç­¾
        msg.sender, msg.message);
    
    PrintToChatAll("%s", sFormattedMsg);
}
```

### æ·»åŠ å†·å´æ—¶é—´

é˜²æ­¢ç©å®¶åˆ·å±ï¼Œå¯ä»¥æ·»åŠ å†·å´ï¼š

```sourcepawn
float g_fLastChatTime[MAXPLAYERS+1];
float g_fChatCooldown = 3.0;  // 3ç§’å†·å´

public Action Cmd_SayRandomChat(int client, int args)
{
    float currentTime = GetGameTime();
    if(currentTime - g_fLastChatTime[client] < g_fChatCooldown)
    {
        PrintToChat(client, "\x02[Chat] \x01Please wait %.1f seconds", 
            g_fChatCooldown - (currentTime - g_fLastChatTime[client]));
        return Plugin_Handled;
    }
    
    g_fLastChatTime[client] = currentTime;
    
    // ... åŸæœ‰ä»£ç  ...
}
```

## ä¸è‡ªåŠ¨æ’­æ”¾ç‰ˆæœ¬çš„åŒºåˆ«

| ç‰¹æ€§ | æ‰‹åŠ¨è§¦å‘ç‰ˆ | è‡ªåŠ¨åŒæ­¥ç‰ˆ |
|------|-----------|----------|
| æ’­æ”¾æ–¹å¼ | ä½¿ç”¨ `!saychat` æ‰‹åŠ¨è§¦å‘ | æ ¹æ®æ—¶é—´è‡ªåŠ¨æ’­æ”¾ |
| æ—¶é—´åŒæ­¥ | æ— éœ€åŒæ­¥ | éœ€è¦ç²¾ç¡®åŒæ­¥ tickrate |
| ä½¿ç”¨éš¾åº¦ | ç®€å• | è¾ƒå¤æ‚ |
| è¶£å‘³æ€§ | â­â­â­â­â­ | â­â­â­ |
| çœŸå®æ€§ | â­â­â­ | â­â­â­â­â­ |
| æ¨èåœºæ™¯ | å¨±ä¹æœã€ç¤¾åŒºæœ | ç«æŠ€æœã€æ•™å­¦æœ |

## æ€»ç»“

**æ‰‹åŠ¨è§¦å‘ç‰ˆçš„ä¼˜åŠ¿ï¼š**
- âœ… æ›´ç®€å•æ˜“ç”¨
- âœ… ä¸ä¾èµ–ç²¾ç¡®çš„æ—¶é—´åŒæ­¥
- âœ… ç©å®¶ä¸»åŠ¨å‚ä¸ï¼Œæ›´æœ‰è¶£
- âœ… é€‚åˆç¤¾åŒºå¨±ä¹

**é€‚ç”¨äºï¼š**
- ç¤¾åŒºæœåŠ¡å™¨
- å¨±ä¹æ¨¡å¼
- å¿«é€Ÿæµ‹è¯•
- ä¸éœ€è¦å®Œå…¨è¿˜åŸæ¯”èµ›çš„åœºæ™¯

äº«å—ä½ çš„èŠå¤©é‡ç°åŠŸèƒ½å§ï¼ğŸ‰ 